<ion-header>
  <ion-navbar color="dark">
    <ion-title>
      Transactions
    </ion-title>
    <ion-buttons end>
      <button ion-button icon-only (click)="closeSearchbar()">
        <ion-icon name="search"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
  <ion-toolbar *ngIf="showSearchbar" color="graphite" no-border-top>
    <ion-searchbar [showCancelButton]="true" (ionCancel)="closeSearchbar()" (ionInput)="findItems($event)" placeholder="Search Cleared Transactions"></ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content *ngIf="isFiltering == true" class="app-background" #content>
  <ion-item-divider class="header" color="headercolor">Filtered Transactions</ion-item-divider>
  <ion-card class="aspire-card" *ngIf="filterItems.length == 0">
    <ion-card-content>
      No transactions found.
    </ion-card-content>
  </ion-card>
  <ion-list>
    <ion-item text-wrap *ngFor='let transaction of filterItems'>
      <ion-icon name="md-lock" item-start color="mediumgray"></ion-icon>
      <ion-label color=dark>{{transaction.name}}
        <div class="category-name ellipses-left">{{transaction.categoryName}}</div>
        <p>{{transaction.date | date:'mediumDate'}}</p>
      </ion-label>

      <ion-note item-end>
        <span class="float-right" [ngClass]="transaction.direction == 'Inflow'  ? 'pos-category' : (transaction.direction == 'Outflow' ? 'neg-category' : 'transfer-category')">
          <ion-icon class="icon-margin" *ngIf="transaction.direction == 'Inflow'" name="md-arrow-round-down" color="wintergreen"></ion-icon>
          <ion-icon class="icon-margin" *ngIf="transaction.direction == 'Transfer'" name="md-swap" color="buttonblue"></ion-icon>
          <ion-icon class="icon-margin" *ngIf="transaction.direction == 'Outflow'" name="md-arrow-round-up" color="cardinalred"></ion-icon>
          {{transaction.amount/100 | currency}}</span>
        <div class="top-spacer"></div>
        <span class="ellipses-right" [ngClass]="transaction.direction == 'Inflow'  ? 'inflow-account-name' : (transaction.direction == 'Outflow' ? 'outflow-account-name' : 'transfer-account-name')">{{transaction.accountName}}</span>
      </ion-note>
    </ion-item>
  </ion-list>
</ion-content>

<ion-content *ngIf="isFiltering == false" class="app-background" #content>

  <!--NO TRANSACTIONS-->
  <ion-card class="aspire-card" *ngIf="pendingTransactions.length == 0 && clearedTransactions.length == 0">
    <ion-card-content>
      You don't have any Transactions.
    </ion-card-content>
  </ion-card>


  <!-- PENDING TRANSACTIONS -->
  <ion-item-divider *ngIf="pendingTransactions.length != 0" class="header" color="headercolor">Pending Transactions</ion-item-divider>
  <ion-list *ngIf="pendingTransactions.length != 0">
    <ion-item-sliding *ngFor='let transaction of pendingTransactions' #slidingItem>
      <ion-item text-wrap>
        <ion-icon name="md-unlock" item-start color="mediumgray"></ion-icon>
        <ion-label color=dark>{{transaction.name}}
          <div class="category-name ellipses-left">{{transaction.categoryName}}</div>
          <p>{{transaction.date | date:'mediumDate'}}</p>
        </ion-label>

        <ion-note item-end>
          <span class="float-right" [ngClass]="transaction.direction == 'Inflow'  ? 'pos-category' : (transaction.direction == 'Outflow' ? 'neg-category' : 'transfer-category')">
            <ion-icon class="icon-margin" *ngIf="transaction.direction == 'Inflow'" name="md-arrow-round-down" color="wintergreen"></ion-icon>
            <ion-icon class="icon-margin" *ngIf="transaction.direction == 'Transfer'" name="md-swap" color="buttonblue"></ion-icon>
            <ion-icon class="icon-margin" *ngIf="transaction.direction == 'Outflow'" name="md-arrow-round-up" color="cardinalred"></ion-icon>
            {{transaction.amount/100 | currency}}</span>
          <div class="top-spacer"></div>
          <span class="ellipses-right" [ngClass]="transaction.direction == 'Inflow'  ? 'inflow-account-name' : (transaction.direction == 'Outflow' ? 'outflow-account-name' : 'transfer-account-name')">{{transaction.accountName}}</span>
        </ion-note>
      </ion-item>
      <ion-item-options (ionSwipe)="clear(slidingItem, transaction._id)" side="left">
        <button class="swipe-buttons" ion-button expandable (click)="clear(slidingItem, transaction._id)">
          <ion-icon name="md-checkbox"></ion-icon>
          CLEAR
        </button>
      </ion-item-options>

      <ion-item-options side="right">
        <button ion-button color="dark" (click)="edit(slidingItem, transaction)">
          <ion-icon name="md-create"></ion-icon>
          EDIT
        </button>
        <button ion-button color="cardinalred" (click)="delete(slidingItem, transaction._id, transaction.sourceCatId, transaction.destCatId, transaction.sourceAcctId, transaction.destAcctId)">
          <ion-icon name="trash"></ion-icon>
          DELETE
        </button>
      </ion-item-options>
    </ion-item-sliding>
  </ion-list>
  <!-- PENDING TRANSACTIONS -->

  <!-- CLEARED TRANSACTIONS -->
  <ion-item-divider *ngIf="clearedTransactions.length != 0" class="header" color="headercolor">Cleared Transactions</ion-item-divider>
  <ion-list *ngIf="clearedTransactions.length != 0">
    <ion-item text-wrap *ngFor='let transaction of clearedTransactions'>
      <ion-icon name="md-lock" item-start color="mediumgray"></ion-icon>
      <ion-label color=dark>{{transaction.name}}
        <div class="category-name ellipses-left">{{transaction.categoryName}}</div>
        <p>{{transaction.date | date:'mediumDate'}}</p>
      </ion-label>

      <ion-note item-end>
        <span class="float-right" [ngClass]="transaction.direction == 'Inflow'  ? 'pos-category' : (transaction.direction == 'Outflow' ? 'neg-category' : 'transfer-category')">
          <ion-icon class="icon-margin" *ngIf="transaction.direction == 'Inflow'" name="md-arrow-round-down" color="wintergreen"></ion-icon>
          <ion-icon class="icon-margin" *ngIf="transaction.direction == 'Transfer'" name="md-swap" color="buttonblue"></ion-icon>
          <ion-icon class="icon-margin" *ngIf="transaction.direction == 'Outflow'" name="md-arrow-round-up" color="cardinalred"></ion-icon>
          {{transaction.amount/100 | currency}}</span>
        <div class="top-spacer"></div>
        <span class="ellipses-right" [ngClass]="transaction.direction == 'Inflow'  ? 'inflow-account-name' : (transaction.direction == 'Outflow' ? 'outflow-account-name' : 'transfer-account-name')">{{transaction.accountName}}</span>
      </ion-note>
    </ion-item>
  </ion-list>
  <ion-infinite-scroll *ngIf="!noMoreTransactions" (ionInfinite)="$event.waitFor(doInfinite())">
    <ion-infinite-scroll-content></ion-infinite-scroll-content>
  </ion-infinite-scroll>
  <!-- CLEARED TRANSACTIONS -->


</ion-content>